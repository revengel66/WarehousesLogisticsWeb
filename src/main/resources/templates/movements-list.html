<!doctype html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${movementListTitle} + ' — движения'">Движения</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body class="bg-light">
<th:block th:replace="fragments/layout :: appHeader('movements')"></th:block>
<main class="management-page py-5"
      id="movementListPage"
      th:attr="data-movement-type=${movementListType},data-list-title=${movementListTitle},data-base-path=${movementListPath}">
    <div class="container">
        <div class="mb-4">
            <a th:href="@{/movements/page}" class="btn btn-outline-dark page-back-btn d-inline-flex align-items-center gap-2">
                <i class="bi bi-arrow-left"></i>
                <span>Назад</span>
            </a>
        </div>
        <div class="d-flex flex-column flex-sm-row justify-content-between align-items-center gap-3 mb-4">
            <div class="text-center text-sm-start">
                <p class="text-uppercase text-muted small mb-1">Учёт операций</p>
                <h1 class="display-6 fw-bold mb-0" th:text="${movementListTitle}">Поставки</h1>
            </div>
            <button class="btn btn-dark d-inline-flex align-items-center gap-2"
                    data-bs-toggle="modal" data-bs-target="#movementAddModal">
                <i class="bi bi-plus-lg"></i>
                Добавить
            </button>
        </div>
        <div class="management-card">
            <div id="movementListLoader" class="text-center py-5">
                <div class="spinner-border text-dark" role="status" aria-hidden="true"></div>
                <p class="text-muted mt-3 mb-0">Загружаем данные...</p>
            </div>
            <div id="movementListEmpty" class="warehouse-empty-state d-none text-center py-5">
                <div class="warehouse-empty-icon text-dark mb-3">
                    <i class="bi bi-arrow-left-right h2 mb-0"></i>
                </div>
                <h2 class="h5 mb-1">Записей нет</h2>
                <p class="text-muted mb-0">Добавьте первую операцию.</p>
            </div>
            <div class="table-responsive d-none" id="movementListTableWrapper">
                <table class="table align-middle management-table">
                    <thead>
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Дата</th>
                        <th scope="col" data-column="warehouse">Склад</th>
                        <th scope="col" data-column="second" class="d-none">—</th>
                        <th scope="col" data-column="third" class="d-none">—</th>
                        <th scope="col" data-column="fourth" class="d-none">—</th>
                        <th scope="col" class="text-end">Действия</th>
                    </tr>
                    </thead>
                    <tbody id="movementListTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</main>
<div class="modal fade" id="movementAddModal" tabindex="-1" aria-labelledby="movementAddModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content modal-spacious border-0 rounded-4 shadow">
            <button type="button" class="btn-close modal-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            <div class="modal-header border-0 justify-content-center pt-0">
                <h2 class="modal-title fs-4 text-center w-100 mb-0" id="movementAddModalLabel">Создать операцию</h2>
            </div>
            <div class="modal-body pt-3">
                <form id="movementAddForm" class="needs-validation movement-form" novalidate>
                    <div class="row g-3">
                        <div class="col-12 col-sm-6" data-field="date">
                        <label for="movementAddDate" class="form-label modal-field-label" data-label-field="date">
                            <span data-label-text>Дата</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <input type="datetime-local" class="form-control" id="movementAddDate" name="date" step="60" required>
                            <div class="invalid-feedback">Укажите дату операции.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="warehouse">
                        <label for="movementAddWarehouse" class="form-label modal-field-label" data-label-field="warehouse">
                            <span data-label-text>Склад</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <select class="form-select" id="movementAddWarehouse" name="warehouseId" required>
                                <option value="" disabled selected>Выберите склад</option>
                            </select>
                            <div class="invalid-feedback">Выберите склад.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="targetWarehouse">
                             <label for="movementAddTargetWarehouse" class="form-label modal-field-label" data-label-field="targetWarehouse">
                                <span data-label-text>Склад приёмки</span>
                            </label>
                            <select class="form-select" id="movementAddTargetWarehouse" name="targetWarehouseId" required>
                                <option value="" disabled selected>Выберите склад приёмки</option>
                            </select>
                            <div class="invalid-feedback">Выберите склад приёмки.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="counterparty">
                            <label for="movementAddCounterparty" class="form-label modal-field-label" data-label-field="counterparty">
                                <span data-label-text>Контрагент</span>
                                <span class="text-danger" data-required-indicator>*</span>
                            </label>
                            <select class="form-select" id="movementAddCounterparty" name="counterpartyId" required>
                                <option value="" disabled selected>Выберите контрагента</option>
                            </select>
                            <div class="invalid-feedback">Выберите контрагента.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="employee">
                            <label for="movementAddEmployee" class="form-label modal-field-label" data-label-field="employee">
                                <span data-label-text>Сотрудник</span>
                                <span class="text-danger" data-required-indicator>*</span>
                            </label>
                            <select class="form-select" id="movementAddEmployee" name="employeeId" required>
                                <option value="" disabled selected>Выберите сотрудника</option>
                            </select>
                            <div class="invalid-feedback">Выберите сотрудника.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="targetEmployee">
                        <label for="movementAddTargetEmployee" class="form-label modal-field-label" data-label-field="targetEmployee">
                            <span data-label-text>Сотрудник приёмки</span>
                        </label>
                            <select class="form-select" id="movementAddTargetEmployee" name="targetEmployeeId" required>
                                <option value="" disabled selected>Выберите сотрудника приёмки</option>
                            </select>
                            <div class="invalid-feedback">Выберите сотрудника приёмки.</div>
                        </div>
                        <div class="col-12">
                            <label for="movementAddInfo" class="form-label modal-field-label">Описание</label>
                            <textarea class="form-control" id="movementAddInfo" name="info" rows="2"
                                      placeholder="Дополнительная информация (необязательно)"></textarea>
                        </div>
                    </div>
                    <div class="d-flex flex-column flex-sm-row gap-3 pt-3">
                        <button type="button" class="btn btn-outline-dark flex-fill" data-bs-dismiss="modal">Отмена</button>
                        <button type="submit" class="btn btn-dark flex-fill" id="movementAddSubmit">
                            <span class="default-text">Сохранить</span>
                            <span class="spinner-border spinner-border-sm align-middle ms-2 d-none" role="status"
                                  aria-hidden="true"></span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="movementEditModal" tabindex="-1" aria-labelledby="movementEditModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content modal-spacious border-0 rounded-4 shadow">
            <button type="button" class="btn-close modal-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            <div class="modal-header border-0 justify-content-center pt-0">
                <h2 class="modal-title fs-4 text-center w-100 mb-0" id="movementEditModalLabel">Редактировать</h2>
            </div>
            <div class="modal-body pt-3">
                <form id="movementEditForm" class="needs-validation movement-form" novalidate>
                    <div class="row g-3">
                        <div class="col-12 col-sm-6" data-field="date">
                        <label for="movementEditDate" class="form-label modal-field-label" data-label-field="date">
                            <span data-label-text>Дата</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <input type="datetime-local" class="form-control" id="movementEditDate" name="date" step="60" required>
                            <div class="invalid-feedback">Укажите дату операции.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="warehouse">
                        <label for="movementEditWarehouse" class="form-label modal-field-label" data-label-field="warehouse">
                            <span data-label-text>Склад</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <select class="form-select" id="movementEditWarehouse" name="warehouseId" required>
                                <option value="" disabled>Выберите склад</option>
                            </select>
                            <div class="invalid-feedback">Выберите склад.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="targetWarehouse">
                        <label for="movementEditTargetWarehouse" class="form-label modal-field-label" data-label-field="targetWarehouse">
                            <span data-label-text>Склад приёмки</span>
                        </label>
                            <select class="form-select" id="movementEditTargetWarehouse" name="targetWarehouseId" required>
                                <option value="" disabled>Выберите склад приёмки</option>
                            </select>
                            <div class="invalid-feedback">Выберите склад приёмки.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="counterparty">
                        <label for="movementEditCounterparty" class="form-label modal-field-label" data-label-field="counterparty">
                            <span data-label-text>Контрагент</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <select class="form-select" id="movementEditCounterparty" name="counterpartyId" required>
                                <option value="" disabled>Выберите контрагента</option>
                            </select>
                            <div class="invalid-feedback">Выберите контрагента.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="employee">
                        <label for="movementEditEmployee" class="form-label modal-field-label" data-label-field="employee">
                            <span data-label-text>Сотрудник</span>
                            <span class="text-danger" data-required-indicator>*</span>
                        </label>
                            <select class="form-select" id="movementEditEmployee" name="employeeId" required>
                                <option value="" disabled>Выберите сотрудника</option>
                            </select>
                            <div class="invalid-feedback">Выберите сотрудника.</div>
                        </div>
                        <div class="col-12 col-sm-6" data-field="targetEmployee">
                        <label for="movementEditTargetEmployee" class="form-label modal-field-label" data-label-field="targetEmployee">
                            <span data-label-text>Сотрудник приёмки</span>
                        </label>
                            <select class="form-select" id="movementEditTargetEmployee" name="targetEmployeeId" required>
                                <option value="" disabled>Выберите сотрудника приёмки</option>
                            </select>
                            <div class="invalid-feedback">Выберите сотрудника приёмки.</div>
                        </div>
                        <div class="col-12">
                            <label for="movementEditInfo" class="form-label modal-field-label">Описание</label>
                            <textarea class="form-control" id="movementEditInfo" name="info" rows="2"
                                      placeholder="Дополнительная информация (необязательно)"></textarea>
                        </div>
                    </div>
                    <div class="d-flex flex-column flex-sm-row gap-3 pt-4">
                        <button type="button" class="btn btn-outline-dark flex-fill" data-bs-dismiss="modal">Отмена</button>
                        <button type="submit" class="btn btn-dark flex-fill" id="movementEditSubmit">
                            <span class="default-text">Сохранить</span>
                            <span class="spinner-border spinner-border-sm align-middle ms-2 d-none" role="status"
                                  aria-hidden="true"></span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="movementListAlertModal" tabindex="-1" aria-labelledby="movementListAlertTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-spacious border-0 rounded-4 shadow">
            <button type="button" class="btn-close modal-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            <div class="modal-header border-0 justify-content-center pt-0">
                <h2 class="modal-title fs-5 text-center w-100 mb-0" id="movementListAlertTitle"
                    data-modal="title">Сообщение</h2>
            </div>
            <div class="modal-body text-body-secondary pt-3 pb-0" data-modal="body">
                Подождите, идёт обработка запроса...
            </div>
            <div class="modal-footer border-0 flex-column flex-sm-row gap-2 pt-3">
                <button type="button" class="btn btn-outline-dark w-100" data-bs-dismiss="modal"
                        data-modal="close">Закрыть</button>
                <button type="button" class="btn btn-dark w-100 d-none" data-modal="action"></button>
            </div>
        </div>
    </div>
</div>
<th:block th:replace="fragments/layout :: logoutModal"></th:block>
<th:block th:replace="fragments/layout :: baseScripts"></th:block>
</body>
</html>
